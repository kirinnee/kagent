version: '3'

tasks:
  setup:
    desc: 'Install dependencies and configure repository'
    cmds:
      - bun install
      - pre-commit install || true

  dev:
    desc: 'Run CLI in development mode'
    cmds:
      - bun run src/cli.ts {{.ARGS}}

  build:
    desc: 'Build standalone binary'
    cmds:
      - bun build --compile --outfile dist/kagent src/cli.ts

  clean:
    desc: 'Clean build artifacts and dependencies'
    cmds:
      - rm -rf dist node_modules coverage

  lint:
    desc: 'Run pre-commit hooks'
    cmds:
      - pre-commit run --all

  deadcode:
    desc: 'Find code only used by tests or not used at all (requires human verification)'
    cmds:
      - bun knip --include classMembers,types

  # Alias for running all tests
  test:
    desc: 'Run all tests (unit + int)'
    cmds:
      - task: test:test

includes:
  test: tasks/test.tasks.yaml
